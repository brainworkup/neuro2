## Visual Perception/Construction {#sec--02-04-spatial}

{{< include _02-04_spatial_text.qmd >}}

```{r}
#| label: setup--02-04-spatial
#| include: false

# Domain-specific data
domains <- c("Visual Perception/Construction")
pheno <- "spatial"
```

```{r}
#| label: data--02-04-spatial
#| include: false

# Filter data
data <- NeurotypR::filter_data(
  data = neurocog,
  domain = domains
)

# Filter by scales
scales <- c("Spatial Index (SPT)", "Visual Discrimination", "Design Construction", "Block Design")
data_scales <- NeurotypR::filter_data(
  data = data,
  scale = scales
)
```

```{r}
#| label: table--02-04-spatial
#| tbl-cap: "Visual Perception/Construction Test Scores"

# Create table
NeurotypR::tbl_gt(
  data = data_scales,
  pheno = pheno,
  table_name = paste0("table_", pheno),
  source_note = "Standard score: Mean = 100 [50th‰], SD ± 15",
  dynamic_grp = pheno
)
```

```{r}
#| label: fig--02-04-spatial-subdomain
#| fig-cap: "Visual Perception/Construction subdomain scores"
#| fig-height: 4
#| fig-width: 6

# Create subdomain plot
data_subdomain <- data |>
  dplyr::group_by(subdomain) |>
  dplyr::summarise(
    z_mean_subdomain = mean(z_mean_subdomain, na.rm = TRUE)
  ) |>
  dplyr::filter(!is.na(z_mean_subdomain))

NeurotypR::dotplot(
  data = data_subdomain,
  x = data_subdomain$z_mean_subdomain,
  y = data_subdomain$subdomain,
  filename = paste0("fig_", pheno, "_subdomain.svg")
)
```

