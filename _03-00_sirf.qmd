# SUMMARY/IMPRESSION {#sec-sirf}

{{< include _03-00_sirf_text.qmd >}}

```{r}
#| label: setup-sirf
#| include: false

# Source R6 classes
source("R/NeuropsychReportSystemR6.R")
source("R/DotplotR6.R")

# Load all domain data
neurocog <- readr::read_csv("data/neurocog.csv")

# Create report system for overall summary
report_system <- NeuropsychReportSystemR6$new(
  config = list(patient = patient, domains = unique(neurocog$domain))
)
```

```{r}
#| label: fig-sirf-overall
#| fig-cap: "Overall cognitive profile across all domains"
#| include: false

# Create overall summary plot
domain_summary <- neurocog |>
  group_by(domain) |>
  summarise(
    mean_z = mean(z, na.rm = TRUE),
    mean_percentile = mean(percentile, na.rm = TRUE)
  ) |>
  filter(!is.na(mean_z))

# Create plot using R6 DotplotR6
overall_plot <- DotplotR6$new(
  data = domain_summary,
  x = "mean_z",
  y = "domain",
  filename = "fig_sirf_overall.svg",
  theme = "fivethirtyeight",
  point_size = 8
)
overall_plot$create_plot()
```

```{=typst}
#let domain(file_fig) = {
  let font = (font: "Roboto Slab", size: 0.9em)
  set text(..font)
  figure(
    [#image(file_fig, width: 70%)],
    placement: none,
    caption: figure.caption(
      position: bottom,
      [
        These plots illustrate the patient's performance across various neurocognitive function subdomains, with z-scores standardized to have a mean of 0 and a standard deviation of Â±1, allowing for clear identification of relative strengths (above +1) and relative weaknesses (below -1).
        ],
    ),
    kind: "image",
    supplement: [Figure],
    gap: 0.5em,
  )
}
```

```{=typst}
#let file_fig = "fig_domains.svg"
#domain(file_fig)
```
