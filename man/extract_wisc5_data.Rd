% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pluck_neuropsych_test_results.R
\name{extract_wisc5_data}
\alias{extract_wisc5_data}
\title{Extract and Process WISC-V Test Data from PDF}
\usage{
extract_wisc5_data(
  patient,
  test_type,
  file_path = NULL,
  pages_index = NULL,
  pages_subtest = NULL,
  pages_process = NULL
)
}
\arguments{
\item{patient}{Character string specifying the patient identifier or name}

\item{test_type}{Character string specifying the type of test data to extract.
Must be one of: "index", "subtest", or "process"}

\item{file_path}{Character string specifying the path to the PDF file. If NULL,
a file chooser dialog will be opened to select the file}

\item{pages_index}{Numeric vector specifying the page numbers to extract for index data.
Required when test_type = "index"}

\item{pages_subtest}{Numeric vector specifying the page numbers to extract for subtest data.
Required when test_type = "subtest"}

\item{pages_process}{Numeric vector specifying the page numbers to extract for process data.
Required when test_type = "process"}
}
\value{
A data frame containing the processed WISC-V test results with the following columns:
\describe{
\item{test}{Test identifier ("wisc5")}
\item{test_name}{Full test name}
\item{scale}{Name of the test scale or subtest}
\item{raw_score}{Raw score obtained}
\item{score}{Standard score (index) or scaled score (subtest/process)}
\item{ci_95}{95\% confidence interval}
\item{percentile}{Percentile rank}
\item{range}{Descriptive performance range}
\item{result}{Interpretive text describing the results}
\item{absort}{Sorting variable for report organization}
}
}
\description{
This function extracts and processes WISC-V (Wechsler Intelligence Scale for Children, 5th Edition)
test data from PDF files. It handles three types of test data: index scores, subtest scores, and
process scores. The function extracts raw data from specified PDF pages, processes and cleans the data,
calculates additional metrics (confidence intervals, percentiles), and generates interpretive text.
}
\details{
The function handles three distinct types of WISC-V data:
\itemize{
\item{\strong{Index scores}: Composite scores with standard score metric
(mean=100, SD=15)}
\item{\strong{Subtest scores}: Individual subtest scores with scaled score metric (mean=10, SD=3)}
\item{\strong{Process scores}: Process-based scores with scaled score metric (mean=10, SD=3)}
}

For subtest and process scores, the function automatically calculates 95\% confidence intervals
using a reliability coefficient of 0.90. Process scores also have percentiles calculated
based on the normal distribution.

The function integrates with a neuropsychological lookup table to add descriptive information
and generates interpretive text for each score. Results are automatically saved to CSV files
in the "data/csv" directory.
}
\examples{
\dontrun{
# Extract WISC-V index scores
index_data <- extract_wisc5_data(
  patient = "Patient001",
  test_type = "index",
  file_path = "path/to/wisc5_report.pdf",
  pages_index = c(32, 35)
)

# Extract subtest scores with custom page numbers
subtest_data <- extract_wisc5_data(
  patient = "Patient001",
  test_type = "subtest",
  pages_subtest = c(30, 31)
)

# Extract process scores (will prompt for file selection)
process_data <- extract_wisc5_data(
  patient = "Patient001",
  test_type = "process",
  pages_process = c(38)
)
}

}
